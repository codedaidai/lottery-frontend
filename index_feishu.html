<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>无限赏抽奖系统 - 飞书版</title>
    
    <!-- 飞书 JSAPI SDK -->
    <script type="text/javascript" src="https://lf-scm-cn.feishucdn.com/lark/op/h5-js-sdk-1.5.44.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container-fluid">
        <!-- 标题栏 -->
        <header class="row bg-primary text-white py-3 mb-4">
            <div class="col-12">
                <h1 class="text-center mb-0">
                    <i class="bi bi-gift-fill"></i> 无限赏抽奖系统控制台
                    <span class="badge bg-success fs-6">飞书版</span>
                </h1>
            </div>
        </header>

        <!-- 主要内容区 -->
        <div class="row">
            <!-- 左侧: 配置区 -->
            <div class="col-lg-7">
                <!-- 基础配置 -->
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><i class="bi bi-gear-fill"></i> 基础配置</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">单次抽奖价格 (元)</label>
                                <input type="number" id="price" class="form-control" value="199" min="1">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">目标利润率 (%)</label>
                                <input type="number" id="targetProfit" class="form-control" value="18" min="0" max="100" step="0.1">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">模拟次数</label>
                                <input type="number" id="simulationCount" class="form-control" value="100000" min="1000" max="10000000" step="1000">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 奖品配置表格 -->
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="bi bi-table"></i> 奖品配置</h5>
                        <div>
                            <button class="btn btn-sm btn-success" id="addPrizeBtn">
                                <i class="bi bi-plus-circle"></i> 添加奖品
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 40%">奖品名称</th>
                                        <th style="width: 20%">概率 (%)</th>
                                        <th style="width: 20%">价值 (元)</th>
                                        <th style="width: 15%">期望成本</th>
                                        <th style="width: 5%">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="prizesTable">
                                    <!-- 由JS动态生成 -->
                                </tbody>
                                <tfoot class="table-light">
                                    <tr class="fw-bold">
                                        <td>总计</td>
                                        <td id="totalProb">0.00%</td>
                                        <td>-</td>
                                        <td id="totalExpected">0.00</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 操作按钮区 -->
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><i class="bi bi-calculator-fill"></i> 操作</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-2">
                            <div class="col-md-4">
                                <button class="btn btn-primary w-100" id="calculateBtn">
                                    <i class="bi bi-calculator"></i> 计算统计
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-warning w-100" id="adjustValuesBtn">
                                    <i class="bi bi-coin"></i> 调整价值
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-info w-100" id="adjustProbsBtn">
                                    <i class="bi bi-percent"></i> 调整概率
                                </button>
                            </div>
                            <div class="col-md-6">
                                <button class="btn btn-success w-100" id="simulateBtn">
                                    <i class="bi bi-arrow-repeat"></i> 运行模拟
                                </button>
                            </div>
                            <div class="col-md-6">
                                <button class="btn btn-danger w-100" id="saveConfigBtn">
                                    <i class="bi bi-save-fill"></i> 保存配置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧: 结果展示区 -->
            <div class="col-lg-5">
                <!-- 统计信息 -->
                <div class="card mb-3">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><i class="bi bi-graph-up"></i> 统计信息</h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-6 mb-3">
                                <div class="stat-card">
                                    <div class="stat-label">期望赔付</div>
                                    <div class="stat-value text-primary" id="statExpected">-</div>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="stat-card">
                                    <div class="stat-label">利润率</div>
                                    <div class="stat-value text-success" id="statProfit">-</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-card">
                                    <div class="stat-label">概率总和</div>
                                    <div class="stat-value" id="statProbSum">-</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-card">
                                    <div class="stat-label">奖品数量</div>
                                    <div class="stat-value text-info" id="statPrizeCount">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 模拟结果 -->
                <div class="card mb-3">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="bi bi-bar-chart-fill"></i> 模拟结果</h5>
                    </div>
                    <div class="card-body">
                        <div id="simulationResults" class="text-muted text-center py-3">
                            <i class="bi bi-arrow-repeat fs-1"></i>
                            <p class="mb-0">点击"运行模拟"查看结果</p>
                        </div>
                    </div>
                </div>

                <!-- 日志区 -->
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h5 class="mb-0"><i class="bi bi-terminal-fill"></i> 操作日志</h5>
                    </div>
                    <div class="card-body p-0">
                        <div id="logArea" class="log-area"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 提示模态框 -->
    <div class="modal fade" id="messageModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="messageModalTitle">提示</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="messageModalBody">
                    <!-- 动态内容 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="script_feishu.js"></script>
</body>
</html>

